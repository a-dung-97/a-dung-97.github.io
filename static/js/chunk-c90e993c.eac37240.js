(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c90e993c"],{"102e":function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return r})),n.d(e,"f",(function(){return o})),n.d(e,"g",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var a=n("b775");function i(t){return Object(a["a"])({url:"/mailing-lists",method:"get",params:t})}function r(t){return Object(a["a"])({url:"/mailing-lists/".concat(t),method:"get"})}function o(t){return Object(a["a"])({url:"/mailing-lists",method:"post",data:t})}function c(t,e){return Object(a["a"])({url:"/mailing-lists/".concat(e),method:"put",data:t})}function l(t){return Object(a["a"])({url:"/mailing-lists/".concat(t),method:"delete"})}function s(t){return Object(a["a"])({url:"/mailing-lists/members",method:"post",data:t})}function u(t,e){return Object(a["a"])({url:"/mailing-lists/".concat(e,"/members"),method:"delete",data:t})}},"3c2c":function(t,e,n){"use strict";n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return o})),n.d(e,"h",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"i",(function(){return m})),n.d(e,"c",(function(){return d}));var a=n("b775");function i(t){return Object(a["a"])({url:"/email-automations",method:"get",params:t})}function r(t){return Object(a["a"])({url:"/email-automations/".concat(t),method:"get"})}function o(t){return Object(a["a"])({url:"/email-automations",method:"post",data:t})}function c(t,e){return Object(a["a"])({url:"/email-automations/".concat(e),method:"put",data:t})}function l(t){return Object(a["a"])({url:"/email-automations/".concat(t,"/active"),method:"put"})}function s(t){return Object(a["a"])({url:"/email-automations/".concat(t,"/email"),method:"get"})}function u(t,e){return Object(a["a"])({url:"/email-automations/".concat(e,"/email"),method:"post",data:t})}function m(t,e){return Object(a["a"])({url:"/email-automations/email/".concat(e),method:"put",data:t})}function d(t){return Object(a["a"])({url:"/email-automations/".concat(t),method:"delete"})}},"469f":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("7d7b")},"5d73":function(t,e,n){t.exports=n("469f")},"5df3":function(t,e,n){"use strict";var a=n("02f4")(!0);n("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=a(e,n),this._i+=t.length,{value:t,done:!1})}))},"768b":function(t,e,n){"use strict";var a=n("a745"),i=n.n(a);function r(t){if(i()(t))return t}var o=n("5d73"),c=n.n(o),l=n("c8bb"),s=n.n(l);function u(t,e){if(s()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],a=!0,i=!1,r=void 0;try{for(var o,l=c()(t);!(a=(o=l.next()).done);a=!0)if(n.push(o.value),e&&n.length===e)break}catch(u){i=!0,r=u}finally{try{a||null==l["return"]||l["return"]()}finally{if(i)throw r}}return n}}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function d(t,e){return r(t)||u(t,e)||m()}n.d(e,"a",(function(){return d}))},"7d7b":function(t,e,n){var a=n("e4ae"),i=n("7cd6");t.exports=n("584a").getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return a(e.call(t))}},a85e:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-row",{staticClass:"mb-20"},[n("SearchForm",{attrs:{params:t.params},on:{"handle-search":t.getData}}),t._v(" "),n("el-col",{attrs:{span:3}},[n("el-button",{staticClass:"fr",attrs:{size:"medium",type:"primary"},on:{click:function(e){return t.showDialogForm("create")}}},[t._v("Thêm email tự động")])],1)],1),t._v(" "),n("el-row",[n("el-col",{attrs:{span:24}},[n("TableData",{attrs:{form:t.form,"table-data":t.tableData,loading:t.loading},on:{"handle-edit":function(e){return t.showDialogForm("edit")},"handle-delete":function(e){return t.getData()},"handle-edit-members":function(e){return t.showDialogTableUpdateMembers(e)},"update:loading":function(e){t.loading=e}}})],1)],1),t._v(" "),n("Pagination",{attrs:{pagination:t.pagination},on:{"size-change":function(e){t.params.perPage=e,t.params.page=1,t.getData()},"current-change":function(e){t.params.page=e,t.getData()}}}),t._v(" "),n("DialogForm",{attrs:{"show-dialog":t.showDialog,"mailing-lists":t.mailingLists,editing:t.editing,form:t.form},on:{reload:function(e){return t.getData()},"update:showDialog":function(e){t.showDialog=e},"update:show-dialog":function(e){t.showDialog=e}}})],1)},i=[],r=(n("ac6a"),n("5df3"),n("768b")),o=(n("96cf"),n("3b8d")),c=n("3c2c"),l=n("102e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"72vh",border:""}},[n("el-table-column",{attrs:{type:"index",width:"50",label:"STT"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"Tên"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{staticClass:"link",on:{click:function(n){return t.$router.push("/automation/email-automation/show/"+e.row.id)}}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"description",label:"Mô tả"}}),t._v(" "),n("el-table-column",{attrs:{label:"Ngày tạo"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("date")(e.row.created_at)))]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",width:"200",label:"Hành động"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"medium",icon:"el-icon-edit",circle:"",type:"primary"},on:{click:function(n){return t.handleEdit(e.row)}}}),t._v(" "),n("el-button",{attrs:{size:"medium",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return t.handleDelete(e.row.id)}}}),t._v(" "),e.row.active?n("el-button",{attrs:{size:"medium",icon:"el-icon-video-pause",circle:"",type:"warning"},on:{click:function(n){return t.changeActive(e.row.id,"Tạm dừng email tự động")}}}):n("el-button",{attrs:{size:"medium",icon:"el-icon-video-play",circle:"",type:"success"},on:{click:function(n){return t.changeActive(e.row.id,"Chạy email tự động")}}})]}}])})],1)],1)},u=[],m=(n("7f7f"),{props:["tableData","loading","form"],methods:{handleEdit:function(t){this.form.id=t.id,this.form.name=t.name,this.form.description=t.description,this.form.mailing_list_id=t.mailing_list_id,this.$emit("handle-edit")},handleDelete:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$confirm("Bạn có chắc chắn muốn xóa?","Cảnh báo",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"});case 2:return this.openFullScreen(),t.next=5,Object(c["c"])(e);case 5:this.closeFullScreen(),this.$message.success("Xóa dữ liệu thành công"),this.$emit("handle-delete");case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeActive:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$confirm(n,"Cảnh báo",{confirmButtonText:"OK",cancelButtonText:"Hủy",type:"warning"});case 2:return this.openFullScreen(),t.next=5,Object(c["b"])(e);case 5:this.closeFullScreen(),this.$message.success("Cập nhật thành công"),this.$emit("handle-delete");case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}(),handleEditMembers:function(t){this.$emit("handle-edit-members",t)}}}),d=m,h=n("2877"),f=Object(h["a"])(d,s,u,!1,null,null,null),p=f.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{width:"30%",center:"",title:this.editing?"Chỉnh sửa email tự động":"Thêm email tự động","before-close":t.closeDialog,visible:t.showDialog},on:{"update:visible":function(e){t.showDialog=e}}},[n("el-form",{ref:"form",attrs:{"label-position":"top",model:t.form,rules:t.rules}},[n("el-form-item",{attrs:{label:"Tên",prop:"name"}},[n("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),t.editing?t._e():n("el-form-item",{attrs:{label:"Danh sách email",prop:"mailing_list_id"}},[n("el-select",{staticClass:"w-100",model:{value:t.form.mailing_list_id,callback:function(e){t.$set(t.form,"mailing_list_id",e)},expression:"form.mailing_list_id"}},t._l(t.mailingLists,(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"Mô tả",prop:"description"}},[n("el-input",{model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.closeDialog}},[t._v("Hủy")]),t._v(" "),t.editing?n("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.updateData}},[t._v("Cập nhật")]):n("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.createData}},[t._v("Tạo mới")])],1)],1)},b=[],v={props:["form","editing","showDialog","mailingLists"],data:function(){return{loading:!1,rules:{name:[{required:!0,message:"Hãy nhập tên email tự động",trigger:"blur"}],mailing_list_id:[{required:!0,message:"Hãy chọn danh sách email",trigger:"blur"}]}}},methods:{closeDialog:function(){this.$emit("update:showDialog",!1),this.$refs["form"].resetFields()},updateData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs["form"].validate();case 3:return this.loading=!0,t.next=6,Object(c["h"])(this.form,this.form.id);case 6:this.reload(),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),this.loading=!1;case 12:case"end":return t.stop()}}),t,this,[[0,9]])})));function e(){return t.apply(this,arguments)}return e}(),createData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs["form"].validate();case 3:return this.loading=!0,t.next=6,Object(c["g"])(this.form);case 6:this.reload(),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),this.loading=!1;case 12:case"end":return t.stop()}}),t,this,[[0,9]])})));function e(){return t.apply(this,arguments)}return e}(),reload:function(){this.loading=!1,this.$message.success(this.editing?"Cập nhật thành công":"Thêm mới thành công"),this.closeDialog(),this.$emit("reload")}}},w=v,_=Object(h["a"])(w,g,b,!1,null,null,null),y=_.exports,D=n("333d"),x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-col",{attrs:{span:21}},[n("el-input",{staticClass:"input-text",attrs:{size:"medium",placeholder:"Nhập tên hoặc mô tả",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$emit("handle-search")}},model:{value:t.params.search,callback:function(e){t.$set(t.params,"search",e)},expression:"params.search"}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-search",circle:""},on:{click:function(e){return t.$emit("handle-search")}}})],1)},O=[],k={props:["params"]},j=k,$=Object(h["a"])(j,x,O,!1,null,null,null),T=$.exports,C={components:{TableData:p,DialogForm:y,Pagination:D["a"],SearchForm:T},data:function(){return{tableData:[],loading:!1,pagination:{},mailingLists:[],params:{perPage:10,page:1,search:""},users:[],showDialog:!1,showDialogTable:!1,editing:!1,form:{name:"",description:"",mailing_list_id:""}}},methods:{getData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,Promise.all([Object(c["e"])(this.params),Object(l["d"])()]);case 4:e=t.sent,n=Object(r["a"])(e,2),a=n[0],i=n[1],this.tableData=a.data,this.pagination=a.meta,this.mailingLists=i.data,this.loading=!1,t.next=16;break;case 14:t.prev=14,t.t0=t["catch"](0);case 16:case"end":return t.stop()}}),t,this,[[0,14]])})));function e(){return t.apply(this,arguments)}return e}(),showDialogForm:function(t){if("edit"==t)this.editing=!0;else{for(var e in this.form)this.form[e]="";this.editing=!1}this.showDialog=!0}},created:function(){this.getData()}},S=C,F=Object(h["a"])(S,a,i,!1,null,null,null);e["default"]=F.exports}}]);