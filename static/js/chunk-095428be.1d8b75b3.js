(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-095428be"],{"1f21":function(e,t,n){},"9eb2":function(e,t,n){"use strict";var a=n("1f21"),o=n.n(a);o.a},ab62:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",[n("div",{staticStyle:{height:"32px","line-height":"32px"},attrs:{slot:"header"},slot:"header"},[e._v("\n        Thông tin mẫu email\n        "),e.isEdit?n("el-button",{staticClass:"fr",attrs:{type:"primary",size:"small"},on:{click:e.updateTemplate}},[e._v("Sửa")]):n("el-button",{staticClass:"fr",attrs:{type:"primary",size:"small"},on:{click:e.createTemplate}},[e._v("Thêm")])],1),e._v(" "),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:18}},[n("TinyMCE",{attrs:{initialValue:e.initialValue,height:700,content:e.form.content},on:{"update:content":function(t){return e.$set(e.form,"content",t)}}})],1),e._v(" "),n("el-col",{attrs:{span:6}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[n("el-form-item",{attrs:{prop:"name"}},[n("el-input",{attrs:{placeholder:"Nhập tên mẫu email"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),n("el-form-item",[n("el-input",{attrs:{type:"textarea",placeholder:"Nhập mô tả"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),e._v(" "),n("el-select",{staticClass:"w-100",attrs:{placeholder:"Chọn trường trộn",clearable:""},model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}},[n("el-option",{attrs:{label:"Tiềm năng",value:"lead"}}),e._v(" "),n("el-option",{attrs:{label:"Khách hàng",value:"customer"}}),e._v(" "),n("el-option",{attrs:{label:"Liên hệ",value:"contact"}})],1),e._v(" "),e.mode?n("el-card",{staticClass:"field-card",staticStyle:{"margin-top":"25px"}},[n("div",{attrs:{slot:"header"},slot:"header"},[e._v("Danh sách trường trộn")]),e._v(" "),n("div",{staticClass:"field-container"},e._l(e.fields[e.mode],(function(t){return n("div",{key:t.value,staticClass:"field"},[n("i",{staticClass:"el-icon-plus",on:{click:function(n){return e.addField(t.value)}}}),e._v(" "),n("span",[e._v(e._s(t.label))])])})),0)]):e._e()],1)],1)],1)},o=[],r=(n("96cf"),n("3b8d")),i=n("64f9"),l=n("e3be"),s={components:{TinyMCE:i["a"]},props:["isEdit"],data:function(){return{mode:"",initialValue:"",form:{id:"",name:"Mẫu email trống",content:"",description:""},fields:{lead:[{label:"Xưng hô",value:"lead_honorific"},{label:"Họ tên đệm",value:"lead_first_name"},{label:"Tên",value:"lead_last_name"},{label:"Email",value:"lead_email"},{label:"Điện thoại",value:"lead_phone_number"},{label:"Di động",value:"lead_mobile_number"},{label:"Fax",value:"lead_fax"},{label:"Địa chỉ văn phòng",value:"lead_office_address"},{label:"Mã số thuế",value:"lead_tax_code"},{label:"Mô tả",value:"lead_description"},{label:"Công ty",value:"lead_company"},{label:"Website",value:"lead_website"},{label:"Facebook",value:"lead_facebook"},{label:"Ngày sinh",value:"lead_birthday"},{label:"Doanh thu",value:"lead_revenue"},{label:"Số nhân viên",value:"lead_number_of_workers"}],customer:[{label:"Mã",value:"customer_code"},{label:"Tên",value:"customer_name"},{label:"Email",value:"customer_email"},{label:"Điện thoại",value:"customer_phone_number"},{label:"Di động",value:"customer_mobile_number"},{label:"Fax",value:"customer_fax"},{label:"Địa chỉ văn phòng",value:"customer_office_address"},{label:"Địa chỉ hóa",value:"customer_invoice_address"},{label:"Địa chỉ giao hàng",value:"customer_delivery_address"},{label:"Mã số thuế",value:"customer_tax_code"},{label:"Mô tả",value:"customer_description"},{label:"Website",value:"customer_website"},{label:"Ngày sinh",value:"customer_birthday"},{label:"Doanh thu",value:"customer_revenue"},{label:"Số nhân viên",value:"customer_number_of_workers"}],contact:[{label:"Xưng hô",value:"contact_honorific"},{label:"Họ tên đệm",value:"contact_first_name"},{label:"Tên",value:"contact_last_name"},{label:"Email",value:"contact_email"},{label:"Điện thoại",value:"contact_phone_number"},{label:"Di động",value:"contact_mobile_number"},{label:"Fax",value:"contact_fax"},{label:"Mô tả",value:"contact_description"},{label:"Facebook",value:"contact_facebook"},{label:"Ngày sinh",value:"contact_birthday"}]},rules:{name:[{required:!0,message:"Hãy nhập tên mẫu",trigger:"blur"}]}}},methods:{addField:function(e){window.tinyMCE.execCommand("mceInsertContent",!1,"%recipient.".concat(e,"%"))},createTemplate:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs["form"].validate();case 3:return this.openFullScreen(),e.next=6,Object(l["d"])(this.form);case 6:t=e.sent,t.data,this.loading=!1,this.closeFullScreen(),this.$message.success("Thêm dữ liệu thành công"),this.$router.push("/marketing/email-template/index"),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](0),console.log(e.t0),this.closeFullScreen();case 18:case"end":return e.stop()}}),e,this,[[0,14]])})));function t(){return e.apply(this,arguments)}return t}(),updateTemplate:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs["form"].validate();case 3:return this.openFullScreen(),e.next=6,Object(l["e"])(this.form,this.$route.params.id);case 6:this.closeFullScreen(),this.$message.success("Sửa dữ liệu thành công"),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0),this.closeFullScreen();case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}(),getTemplate:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.openFullScreen(),e.next=3,Object(l["c"])(this.$route.params.id);case 3:for(a in t=e.sent,n=t.data,this.form)this.form[a]=n[a];this.initialValue=n.content,this.closeFullScreen();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){this.isEdit&&this.getTemplate()}},c=s,u=(n("9eb2"),n("2877")),d=Object(u["a"])(c,a,o,!1,null,null,null);t["a"]=d.exports},c4a9:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var a=function(){return"undefined"!==typeof window?window:e},o=function(){var e=a();return e&&e.tinymce?e.tinymce:null}}).call(this,n("c8ba"))},ca72:function(e,t,n){"use strict";var a=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],o=function(e){return-1!==a.indexOf(e)},r=function(e,t,n){Object.keys(t).filter(o).forEach((function(a){var o=t[a];"function"===typeof o&&("onInit"===a?o(e,n):n.on(a.substring(2),(function(e){return o(e,n)})))}))},i=function(e,t){var n,a=e.$props.modelEvents?e.$props.modelEvents:null,o=Array.isArray(a)?a.join(" "):a;e.$watch("value",(function(e,a){t&&"string"===typeof e&&e!==n&&e!==a&&(t.setContent(e),n=e)})),t.on(o||"change keyup undo redo",(function(){n=t.getContent(),e.$emit("input",n)}))},l=function(e,t,n){var a=t.$props.value?t.$props.value:"",o=t.$props.initialValue?t.$props.initialValue:"";n.setContent(a||o),t.$listeners.input&&i(t,n),r(e,t.$listeners,n)},s=0,c=function(e){var t=Date.now(),n=Math.floor(1e9*Math.random());return s++,e+"_"+n+s+String(t)},u=function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()},d=function(e){return"undefined"===typeof e||""===e?[]:Array.isArray(e)?e:e.split(" ")},p=function(e,t){return d(e).concat(d(t))},m=function(e,t,n,a){var o=t.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=e,o.addEventListener("load",a),o.src=n,t.head&&t.head.appendChild(o)},h=function(){return{listeners:[],scriptId:c("tiny-script"),scriptLoaded:!1}},f=function(e,t,n,a){e.scriptLoaded?a():(e.listeners.push(a),t.getElementById(e.scriptId)||m(e.scriptId,t,n,(function(){e.listeners.forEach((function(e){return e()})),e.scriptLoaded=!0})))},v=n("c4a9"),b={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean},_=function(){return _=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},_.apply(this,arguments)},g=h(),y=function(e,t,n){return e(n||"div",{attrs:{id:t}})},$=function(e,t){return e("textarea",{attrs:{id:t},style:{visibility:"hidden"}})},C=function(e){return function(){var t=_({},e.$props.init,{readonly:e.$props.disabled,selector:"#"+e.elementId,plugins:p(e.$props.init&&e.$props.init.plugins,e.$props.plugins),toolbar:e.$props.toolbar||e.$props.init&&e.$props.init.toolbar,inline:e.inlineEditor,setup:function(t){e.editor=t,t.on("init",(function(n){return l(n,e,t)})),e.$props.init&&"function"===typeof e.$props.init.setup&&e.$props.init.setup(t)}});u(e.element)&&(e.element.style.visibility=""),Object(v["a"])().init(t)}},w={props:b,created:function(){this.elementId=this.$props.id||c("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(v["a"])())C(this)();else if(this.element&&this.element.ownerDocument){var e=this.element.ownerDocument,t=this.$props.cloudChannel?this.$props.cloudChannel:"5",n=this.$props.apiKey?this.$props.apiKey:"no-api-key";f(g,e,"https://cdn.tiny.cloud/1/"+n+"/tinymce/"+t+"/tinymce.min.js",C(this))}},beforeDestroy:function(){null!==Object(v["a"])()&&Object(v["a"])().remove(this.editor)},render:function(e){return this.inlineEditor?y(e,this.elementId,this.$props.tagName):$(e,this.elementId)}};t["a"]=w},d4c1:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("TemplateDetail",{attrs:{isEdit:!0}})},o=[],r=n("ab62"),i={components:{TemplateDetail:r["a"]}},l=i,s=n("2877"),c=Object(s["a"])(l,a,o,!1,null,null,null);t["default"]=c.exports},e3be:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return s}));var a=n("b775");function o(e){return Object(a["a"])({url:"/email-templates",method:"get",params:e})}function r(e){return Object(a["a"])({url:"/email-templates/".concat(e),method:"get"})}function i(e){return Object(a["a"])({url:"/email-templates",method:"post",data:e})}function l(e,t){return Object(a["a"])({url:"/email-templates/".concat(t),method:"put",data:e})}function s(e){return Object(a["a"])({url:"/email-templates/".concat(e),method:"delete"})}}}]);