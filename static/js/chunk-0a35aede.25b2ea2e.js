(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a35aede"],{"11e9":function(t,e,n){var r=n("52a7"),a=n("4630"),o=n("6821"),i=n("6a99"),l=n("69a8"),s=n("c69a"),c=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?c:function(t,e){if(t=o(t),e=i(e,!0),s)try{return c(t,e)}catch(n){}if(l(t,e))return a(!r.f.call(t,e),t[e])}},"5dbc":function(t,e,n){var r=n("d3f4"),a=n("8b97").set;t.exports=function(t,e,n){var o,i=e.constructor;return i!==n&&"function"==typeof i&&(o=i.prototype)!==n.prototype&&r(o)&&a&&a(t,o),t}},"5df3":function(t,e,n){"use strict";var r=n("02f4")(!0);n("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},"85d3":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-card",[n("div",{staticStyle:{height:"32px"},attrs:{slot:"header"},slot:"header"},[t._v("\n            Tạo quy tắc chấm điểm để định lượng khách hàng tiềm năng dựa trên các thông tin\n            "),n("el-button",{staticClass:"fr",attrs:{size:"small",type:"primary"},on:{click:function(e){return t.showDialogForm("create")}}},[t._v("Thêm quy tắc")])],1),t._v(" "),n("el-row",[n("el-col",{attrs:{span:24}},[n("TableData",{attrs:{form:t.form,"table-data":t.tableData,loading:t.loading,options:t.catalogs},on:{"handle-edit":function(e){return t.showDialogForm("edit")},"handle-delete":function(e){return t.getData()},"update:loading":function(e){t.loading=e}}})],1)],1),t._v(" "),n("h5",{staticStyle:{"margin-bottom":"0"}},[t._v("* Điểm tiềm năng sẽ được cập nhật tự động khi thêm, xóa, sửa 1 quy tắc hoặc khi thêm hay sửa tiềm năng")])],1),t._v(" "),n("DialogForm",{attrs:{"show-dialog":t.showDialog,editing:t.editing,form:t.form,options:t.catalogs},on:{reload:function(e){return t.getData()},"update:showDialog":function(e){t.showDialog=e},"update:show-dialog":function(e){t.showDialog=e}}})],1)},a=[],o=(n("ac6a"),n("5df3"),n("96cf"),n("3b8d")),i=n("b775");function l(t){return Object(i["a"])({url:"/lead-score-rules",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/lead-score-rules",method:"post",data:t})}function c(t,e){return Object(i["a"])({url:"/lead-score-rules/".concat(e),method:"put",data:t})}function u(t){return Object(i["a"])({url:"/lead-score-rules/".concat(t),method:"delete"})}var f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{height:"68vh",data:t.tableData}},[n("el-table-column",{attrs:{type:"index",width:"50",label:"STT"}}),t._v(" "),n("el-table-column",{attrs:{label:"Trường tiềm năng"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{color:"#2980b9"}},[t._v(t._s(e.row.field))]),t._v(" "),n("span",[t._v(t._s(t._f("condition")(e.row.condition,e.row.field)))]),t._v(" "),n("span",{staticStyle:{color:"#2980b9"}},[t._v(t._s(t._f("value")(e.row.value,e.row.field,t.options)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"Quy tắc"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.action?"Cộng":"Trừ"))]),t._v(" "),n("span",[t._v(t._s(e.row.score)+" điểm")])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"Ngày áp dụng"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("date")(e.row.created_at)))]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",width:"200",label:"Hành động"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"medium",icon:"el-icon-edit",circle:"",type:"success"},on:{click:function(n){return t.handleEdit(e.row)}}}),t._v(" "),n("el-button",{attrs:{size:"medium",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return t.handleDelete(e.row.id)}}})]}}])})],1)],1)},h=[],d=(n("c5f6"),n("6b54"),n("a481"),n("7f7f"),n("7514"),{props:["tableData","loading","form","options"],filters:{value:function(t,e,n){if(null==t)return"";if("Nguồn"==e){if(n["Nguồn"].find((function(e){return e.id==t})))return n["Nguồn"].find((function(e){return e.id==t})).name}else{if("Ngành nghề"!=e)return"Doanh thu"==e?t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")+" đ":t;if(n["Ngành nghề"].find((function(e){return e.id==t})))return n["Ngành nghề"].find((function(e){return e.id==t})).name}},condition:function(t,e){return"Nguồn"==e||"Ngành nghề"==e?"="==t?"là":"!="==t?"không là":t:t}},methods:{handleEdit:function(t){var e=this;this.form.id=t.id,this.form.field=t.field,this.form.condition=t.condition,this.form.value=Number(t.value),this.form.action=t.action,this.form.score=t.score,setTimeout((function(){e.$emit("handle-edit")}),0)},handleDelete:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$confirm("Bạn có chắc chắn muốn xóa?","Cảnh báo",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"});case 2:return this.openFullScreen(),t.next=5,u(e);case 5:this.$message.success("Xóa dữ liệu thành công"),this.$emit("handle-delete"),this.closeFullScreen();case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}}),g=d,p=n("2877"),m=Object(p["a"])(g,f,h,!1,null,null,null),v=m.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{width:"30%",center:"",title:this.editing?"Chỉnh sửa quy tắc":"Thêm quy tắc","before-close":t.closeDialog,visible:t.showDialog},on:{"update:visible":function(e){t.showDialog=e}}},[n("el-form",{ref:"form",attrs:{"label-width":"100px","label-position":"left",model:t.form,rules:t.rules}},[n("el-form-item",{attrs:{label:"Tên trường",prop:"field"}},[n("el-select",{staticClass:"w-100",attrs:{placeholder:"Chọn tên trường"},model:{value:t.form.field,callback:function(e){t.$set(t.form,"field",e)},expression:"form.field"}},[n("el-option",{attrs:{label:"Nguồn",value:"Nguồn"}}),t._v(" "),n("el-option",{attrs:{label:"Tổng số nhân viên",value:"Tổng số nhân viên"}}),t._v(" "),n("el-option",{attrs:{label:"Doanh thu",value:"Doanh thu"}}),t._v(" "),n("el-option",{attrs:{label:"Ngành nghề",value:"Ngành nghề"}})],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"Điều kiện",prop:"condition"}},[n("el-select",{staticClass:"w-100",attrs:{disabled:""==t.form.field,placeholder:"Chọn điều kiện"},on:{change:t.handleChange},model:{value:t.form.condition,callback:function(e){t.$set(t.form,"condition",e)},expression:"form.condition"}},["Nguồn"==t.form.field||"Ngành nghề"==t.form.field?[n("el-option",{attrs:{label:"Là",value:"="}}),t._v(" "),n("el-option",{attrs:{label:"Không là",value:"!="}}),t._v(" "),n("el-option",{attrs:{label:"Bỏ trống",value:"bỏ trống"}}),t._v(" "),n("el-option",{attrs:{label:"Không bỏ trống",value:"không bỏ trống"}})]:[n("el-option",{attrs:{label:"=",value:"="}}),t._v(" "),n("el-option",{attrs:{label:"!=",value:"!="}}),t._v(" "),n("el-option",{attrs:{label:"<",value:"<"}}),t._v(" "),n("el-option",{attrs:{label:"<=",value:"<="}}),t._v(" "),n("el-option",{attrs:{label:">",value:">"}}),t._v(" "),n("el-option",{attrs:{label:">=",value:">="}}),t._v(" "),n("el-option",{attrs:{label:"Bỏ trống",value:"bỏ trống"}}),t._v(" "),n("el-option",{attrs:{label:"Không bỏ trống",value:"không bỏ trống"}})]],2)],1),t._v(" "),n("el-form-item",{attrs:{label:"Giá trị"}},["Nguồn"==t.form.field||"Ngành nghề"==t.form.field?n("el-select",{staticClass:"w-100",attrs:{disabled:"bỏ trống"==t.form.condition||"không bỏ trống"==t.form.condition,placeholder:"Chọn giá trị"},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}},["Nguồn"==t.form.field?t._l(t.options["Nguồn"],(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):t._l(t.options["Ngành nghề"],(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],2):n("el-input",{attrs:{disabled:"bỏ trống"==t.form.condition||"không bỏ trống"==t.form.condition,type:"number",min:0,placeholder:"Chọn giá trị"},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Hành động",prop:"action"}},[n("el-switch",{attrs:{"active-text":"Cộng","inactive-text":"Trừ"},model:{value:t.form.action,callback:function(e){t.$set(t.form,"action",e)},expression:"form.action"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Điểm",prop:"score"}},[n("el-input-number",{staticClass:"w-100",attrs:{min:0},model:{value:t.form.score,callback:function(e){t.$set(t.form,"score",e)},expression:"form.score"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.closeDialog}},[t._v("Hủy")]),t._v(" "),t.editing?n("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.updateData}},[t._v("Cập nhật")]):n("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.createData}},[t._v("Tạo mới")])],1)],1)},_=[],w={props:["form","editing","showDialog","options"],data:function(){return{loading:!1,rules:{field:[{required:!0,message:"Hãy chọn trường",trigger:"blur"}],condition:[{required:!0,message:"Hãy chọn điều kiện",trigger:"blur"}]}}},methods:{closeDialog:function(){this.$emit("update:showDialog",!1),this.$refs["form"].resetFields()},updateData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs["form"].validate();case 3:return this.loading=!0,t.next=6,c(this.form,this.form.id);case 6:this.reload(),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),this.loading=!1;case 12:case"end":return t.stop()}}),t,this,[[0,9]])})));function e(){return t.apply(this,arguments)}return e}(),createData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs["form"].validate();case 3:if("bỏ trống"==this.form.condition||"không bỏ trống"==this.form.condition){t.next=7;break}if(""!=this.form.value){t.next=7;break}return this.$message.error("Bạn chưa nhập giá trị"),t.abrupt("return");case 7:return this.loading=!0,t.next=10,s(this.form);case 10:this.reload(),t.next=15;break;case 13:t.prev=13,t.t0=t["catch"](0);case 15:case"end":return t.stop()}}),t,this,[[0,13]])})));function e(){return t.apply(this,arguments)}return e}(),handleChange:function(t){"bỏ trống"!=t&&"không bỏ trống"!=t||(this.form.value="")},reload:function(){this.loading=!1,this.$message.success(this.editing?"Cập nhật thành công":"Thêm mới thành công"),this.closeDialog(),this.$emit("reload")}}},y=w,k=Object(p["a"])(y,b,_,!1,null,null,null),N=k.exports,x={components:{TableData:v,DialogForm:N},data:function(){return{tableData:[],loading:!1,pagination:{},showDialog:!1,editing:!1,form:{field:"",condition:"",value:"",score:"",action:!0},catalogs:{"Nguồn":[],"Ngành nghề":[]}}},methods:{getData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,l(this.params);case 4:e=t.sent,this.tableData=e.data,this.pagination=e.meta,this.loading=!1,t.next=12;break;case 10:t.prev=10,t.t0=t["catch"](0);case 12:case"end":return t.stop()}}),t,this,[[0,10]])})));function e(){return t.apply(this,arguments)}return e}(),showDialogForm:function(t){if("edit"==t)this.editing=!0;else{for(var e in this.form)this.form[e]="";this.form.action=!0,this.editing=!1}this.showDialog=!0}},created:function(){Promise.all([this.getCatalog("Tiềm năng","Nguồn"),this.getCatalog("Tiềm năng","Ngành nghề"),this.getData()])}},D=x,T=Object(p["a"])(D,r,a,!1,null,null,null);e["default"]=T.exports},"8b97":function(t,e,n){var r=n("d3f4"),a=n("cb7c"),o=function(t,e){if(a(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(a){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},9093:function(t,e,n){var r=n("ce10"),a=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,a)}},aa77:function(t,e,n){var r=n("5ca1"),a=n("be13"),o=n("79e5"),i=n("fdef"),l="["+i+"]",s="​",c=RegExp("^"+l+l+"*"),u=RegExp(l+l+"*$"),f=function(t,e,n){var a={},l=o((function(){return!!i[t]()||s[t]()!=s})),c=a[t]=l?e(h):i[t];n&&(a[n]=c),r(r.P+r.F*l,"String",a)},h=f.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};t.exports=f},c5f6:function(t,e,n){"use strict";var r=n("7726"),a=n("69a8"),o=n("2d95"),i=n("5dbc"),l=n("6a99"),s=n("79e5"),c=n("9093").f,u=n("11e9").f,f=n("86cc").f,h=n("aa77").trim,d="Number",g=r[d],p=g,m=g.prototype,v=o(n("2aeb")(m))==d,b="trim"in String.prototype,_=function(t){var e=l(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():h(e,3);var n,r,a,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+e}for(var i,s=e.slice(2),c=0,u=s.length;c<u;c++)if(i=s.charCodeAt(c),i<48||i>a)return NaN;return parseInt(s,r)}}return+e};if(!g(" 0o1")||!g("0b1")||g("+0x1")){g=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof g&&(v?s((function(){m.valueOf.call(n)})):o(n)!=d)?i(new p(_(e)),n,g):_(e)};for(var w,y=n("9e1e")?c(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;y.length>k;k++)a(p,w=y[k])&&!a(g,w)&&f(g,w,u(p,w));g.prototype=m,m.constructor=g,n("2aba")(r,d,g)}},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);