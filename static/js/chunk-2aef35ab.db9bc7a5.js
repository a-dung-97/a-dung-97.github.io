(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2aef35ab"],{4783:function(e,t,n){},ab6f:function(e,t,n){},b5af:function(e,t,n){"use strict";var a=n("4783"),r=n.n(a);r.a},ecac:function(e,t,n){"use strict";n.r(t);var a,r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[e.user?n("div",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:6,xs:24}},[n("user-card",{attrs:{user:e.user}})],1),e._v(" "),n("el-col",{attrs:{span:18,xs:24}},[n("el-card",[n("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("el-tab-pane",{attrs:{label:"Tài khoản",name:"account"}},[n("account",{attrs:{user:e.user}})],1),e._v(" "),n("el-tab-pane",{attrs:{label:"Email",name:"email"}},[n("Email")],1)],1)],1)],1)],1)],1):e._e()])},s=[],i=(n("7f7f"),n("db72")),o=n("2f62"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{staticStyle:{"margin-bottom":"20px"}},[n("div",{staticClass:"clearfix text-center",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("Thông tin tài khoản")])]),e._v(" "),n("div",{staticClass:"user-profile"},[n("div",{staticClass:"box-center avatar"},[n("el-avatar",{attrs:{src:e.user.avatar||"https://ui-avatars.com/api/?name="+e.$store.getters.name,icon:"el-icon-user-solid",size:150}}),e._v(" "),n("el-button",{staticClass:"btn-avatar btn-hidden",attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:e.handleUpload}}),e._v(" "),e.isSelectedImage?n("el-button",{staticClass:"btn-avatar btn-submit",attrs:{loading:e.loading,type:"success",icon:"el-icon-check",circle:""},on:{click:e.changeAvatar}}):e._e(),e._v(" "),n("input",{ref:"upload-image",staticClass:"upload-image",attrs:{type:"file"},on:{change:function(t){return e.onImageChange(t)}}})],1),e._v(" "),n("div",{staticClass:"box-center"},[n("div",{staticClass:"user-name text-center"},[e._v(e._s(e.user.name))])])]),e._v(" "),n("div",{staticClass:"user-bio"},[n("div",{staticClass:"user-bio-section"},[n("div",{staticClass:"user-bio-section-header"},[n("svg-icon",{attrs:{"icon-class":"education"}}),e._v(" "),n("span",[e._v(e._s(e.user.position))])],1)]),e._v(" "),n("div",{staticClass:"user-bio-section"},[n("div",{staticClass:"user-bio-section-header"},[n("svg-icon",{attrs:{"icon-class":"skill"}}),e._v(" "),n("span",[e._v(e._s(e.user.department||"Công ty"))])],1)])])])},l=[],u=(n("96cf"),n("3b8d")),m=n("c103"),h={props:{user:{type:Object,default:function(){return{name:"",position:"",department:"",roles:"",avatar:""}}}},data:function(){return{loading:!1,isSelectedImage:!1}},methods:{handleUpload:function(){this.$refs["upload-image"].click()},onImageChange:function(e){this.isSelectedImage=!0;var t=e.target.files||e.dataTransfer.files;if(t.length)return/\.(png|jpg)$/.test(t[0].name)?void this.createImage(t[0]):(this.$message.error("Hãy upload file jpg hoặc png"),void(this.isSelectedImage=!1));this.isSelectedImage=!1},createImage:function(e){var t=new FileReader,n=this;t.onload=function(e){n.user.avatar=e.target.result},t.readAsDataURL(e)},changeAvatar:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,Object(m["a"])({avatar:this.user.avatar});case 4:t=e.sent,this.isSelectedImage=!1,this.loading=!1,this.$store.commit("user/SET_AVATAR",t.data.avatar),this.$message.success("Cập nhật avatar thành công!"),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),this.loading=!1;case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()}},p=h,d=(n("fdfb"),n("2877")),f=Object(d["a"])(p,c,l,!1,null,"772c434e",null),g=f.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{ref:"form",attrs:{model:e.company,rules:e.rules}},[n("el-form-item",{attrs:{label:"Tên công ty",prop:"name"}},[n("el-input",{model:{value:e.company.name,callback:function(t){e.$set(e.company,"name",t)},expression:"company.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Địa chỉ",prop:"address"}},[n("el-input",{model:{value:e.company.address,callback:function(t){e.$set(e.company,"address",t)},expression:"company.address"}})],1),e._v(" "),n("el-form-item",[n("el-button",{staticClass:"block mx-auto",attrs:{type:"primary"},on:{click:e.submit}},[e._v("Cập nhật")])],1)],1)},v=[],w={data:function(){return{loading:!1,company:{name:"",address:""},rules:{name:[{required:!0,message:"Hãy nhập tên công ty của bạn",trigger:"blur"}],address:[{required:!0,message:"Hãy nhập địa chỉ công ty của bạn",trigger:"blur"}]}}},methods:{submit:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;e.updateCompany()}))},getCompany:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(m["f"])();case 3:t=e.sent,this.company=t.data,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}(),updateCompany:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,Object(m["x"])(this.company);case 4:this.$store.commit("user/SET_COMPANY",this.company.name),this.loading=!1,this.$message.success("Cập nhật thành công"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),this.loading=!1;case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}()},created:function(){this.getCompany()}},_=w,y=Object(d["a"])(_,b,v,!1,null,null,null),x=y.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{ref:"form",attrs:{model:e.user,rules:e.rules}},[n("el-form-item",{attrs:{label:"Họ tên",prop:"name"}},[n("el-input",{model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Số điện thoại",prop:"phone_number"}},[n("el-input",{model:{value:e.user.phone_number,callback:function(t){e.$set(e.user,"phone_number","string"===typeof t?t.trim():t)},expression:"user.phone_number"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Email"}},[n("el-input",{attrs:{disabled:"",placeholder:e.user.email}})],1)],1),e._v(" "),n("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.submit}},[e._v("Cập nhật")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showDialog=!0}}},[e._v("Đổi mật khẩu")]),e._v(" "),n("ChangePassword",{attrs:{"show-dialog":e.showDialog},on:{"update:showDialog":function(t){e.showDialog=t},"update:show-dialog":function(t){e.showDialog=t}}})],1)},C=[],$=n("61f7"),j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"Đổi mật khẩu","close-on-click-modal":!1,center:"",visible:e.showDialog,"before-close":e.closeDialog,width:"40%"},on:{"update:visible":function(t){e.showDialog=t}}},[n("el-form",{ref:"form",attrs:{"label-position":"left","label-width":"150px",rules:e.rules,model:e.form}},[n("el-form-item",{attrs:{prop:"old_password",label:"Mật khẩu cũ"}},[n("el-input",{attrs:{"show-password":""},model:{value:e.form.old_password,callback:function(t){e.$set(e.form,"old_password",t)},expression:"form.old_password"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"password",label:"Mật khẩu mới"}},[n("el-input",{attrs:{"show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"password_confirmation",label:"Xác nhận mật khẩu"}},[n("el-input",{attrs:{"show-password":""},model:{value:e.form.password_confirmation,callback:function(t){e.$set(e.form,"password_confirmation",t)},expression:"form.password_confirmation"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.closeDialog}},[e._v("Hủy")]),e._v(" "),n("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.changePassword}},[e._v("Lưu")])],1)],1)},O=[],E={props:["showDialog"],data:function(){return{form:{old_password:"",password:"",password_confirmation:""},rules:{old_password:[{required:!0,message:"Hãy nhập mật khẩu cũ",trigger:"blur"}],password:[{required:!0,message:"Hãy nhập mật khẩu",trigger:"blur"}],password_confirmation:[{required:!0,message:"Hãy nhập lại mật khẩu",trigger:"blur"}]},loading:!1}},methods:{changePassword:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs["form"].validate();case 3:return this.loading=!0,e.next=6,Object(m["b"])(this.form);case 6:this.loading=!1,this.next=!0,this.closeDialog(),this.$message.success("Đổi mật khẩu thành công"),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](0),this.loading=!1,console.log(e.t0);case 16:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(){return e.apply(this,arguments)}return t}(),closeDialog:function(){this.$emit("update:showDialog",!1),this.$refs["form"].resetFields()}}},R=E,D=(n("b5af"),Object(d["a"])(R,j,O,!1,null,"49b7f7ec",null)),S=D.exports,A={components:{ChangePassword:S},props:{user:{type:Object,default:function(){return{id:"",name:"",email:"",phone_number:""}}}},data:function(){return{loading:!1,showDialog:!1,rules:{name:[{required:!0,message:"Hãy nhập tên của bạn",trigger:"blur"}],phone_number:[{validator:$["c"],trigger:"blur"}]}}},methods:{submit:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;e.updateUser()}))},updateUser:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,Object(m["w"])({name:this.user.name,phone_number:this.user.phone_number},this.user.id);case 4:this.$store.commit("user/SET_NAME",this.user.name),this.$store.commit("user/SET_PHONE_NUMBER",this.user.phone_number),this.loading=!1,this.$message.success("Cập nhật thành công"),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.loading=!1;case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}()}},T=A,H=Object(d["a"])(T,k,C,!1,null,null,null),F=H.exports,I=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",[n("el-button",{staticClass:"fr",attrs:{type:"primary",size:"small",icon:"el-icon-plus",circle:""},on:{click:function(t){e.showDialog=!0,e.form.email=""}}}),e._v(" "),n("el-button",{staticClass:"fr mr-10",attrs:{type:"primary",size:"small",icon:"el-icon-refresh",circle:""},on:{click:e.getEmailAddresses}})],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData}},[n("el-table-column",{attrs:{prop:"email",label:"Email"}}),e._v(" "),n("el-table-column",{attrs:{label:"Xác nhận"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(0==t.row.verified?"Chưa xác nhận":1==t.row.verified?"Chờ xác nhận":"Đã xác nhận"))]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"Email chính"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.primary?n("i",{staticClass:"el-icon-check"}):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",width:"170",label:"Hành động"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.primary?e._e():n("el-tooltip",{attrs:{content:"Email chính",placement:"top"}},[n("el-button",{attrs:{size:"small",icon:"el-icon-message",type:"primary",circle:""},on:{click:function(n){return e.setPrimary(t.row.id)}}})],1),e._v(" "),2!=t.row.verified?n("el-tooltip",{attrs:{content:"Gửi email xác nhận",placement:"top"}},[n("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-position",circle:""},on:{click:function(n){return e.sendConfirmEmail(t.row.id)}}})],1):e._e(),e._v(" "),n("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(n){return e.deleteEmailAddress(t.row.id)}}})]}}])})],1),e._v(" "),n("el-dialog",{attrs:{width:"30%",center:"",title:"Thêm địa chỉ email",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t}}},[n("el-form",{ref:"form",attrs:{"label-position":"left",labelWidth:"120px",model:e.form,rules:e.rules}},[n("el-form-item",{attrs:{label:"Địa chỉ email",prop:"email"}},[n("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("Hủy")]),e._v(" "),n("el-button",{attrs:{loading:e.btnLoading,type:"primary"},on:{click:e.createEmailAddress}},[e._v("Tạo mới")])],1)],1)],1)},P=[],U=n("bd86"),q={data:function(){return{tableData:[],loading:!1,btnLoading:!1,showDialog:!1,form:{email:""},rules:{email:[{required:!0,message:"Hãy nhập địa chỉ email",trigger:"blur"},{type:"email",message:"Địa chỉ email không chính xác",trigger:"blur"}]}}},methods:(a={getEmailAddresses:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,Object(m["g"])();case 4:t=e.sent,n=t.data,this.tableData=n,this.loading=!1,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.loading=!1;case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}(),deleteEmailAddress:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("Bạn có chắc chắn muốn xóa?","Cảnh báo",{confirmButtonText:"Xóa",cancelButtonText:"Hủy",type:"warning"});case 2:return this.openFullScreen(),e.next=5,Object(m["d"])(t);case 5:this.closeFullScreen(),this.$message.success("Xóa dữ liệu thành công"),this.getEmailAddresses();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),setPrimary:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("Bạn có muốn đặt địa chỉ email chính?","Xác nhận",{confirmButtonText:"OK",cancelButtonText:"Hủy",type:"warning"});case 2:return this.openFullScreen(),e.next=5,Object(m["u"])(t);case 5:this.closeFullScreen(),this.$message.success("Đặt email chính thành công"),this.getEmailAddresses();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),sendConfirmEmail:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.openFullScreen(),e.next=3,Object(m["s"])(t);case 3:this.closeFullScreen(),this.$message.success("Gửi email xác nhận thành công"),this.getEmailAddresses();case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},Object(U["a"])(a,"sendConfirmEmail",function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.openFullScreen(),e.next=3,Object(m["s"])(t);case 3:this.closeFullScreen(),this.$message.success("Gửi email xác nhận thành công"),this.getEmailAddresses();case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()),Object(U["a"])(a,"createEmailAddress",function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs["form"].validate();case 3:return this.btnLoading=!0,e.next=6,Object(m["c"])(this.form);case 6:this.btnLoading=!1,this.$message.success("Thêm địa chỉ email thành công"),this.showDialog=!1,this.getEmailAddresses(),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),this.btnLoading=!1;case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(){return e.apply(this,arguments)}return t}()),a),created:function(){this.getEmailAddresses()}},B=q,L=Object(d["a"])(B,I,P,!1,null,null,null),z=L.exports,M={name:"Profile",components:{Company:x,Account:F,UserCard:g,Email:z},data:function(){return{user:{},activeTab:"account"}},computed:Object(i["a"])({},Object(o["b"])(["id","name","avatar","roles","position","department","phone_number","email"])),created:function(){this.getUser()},methods:{getUser:function(){this.user={id:this.id,name:this.name,role:this.roles.join(" | "),email:this.email,avatar:this.avatar,phone_number:this.phone_number,position:this.position,department:this.department}}}},N=M,X=Object(d["a"])(N,r,s,!1,null,null,null);t["default"]=X.exports},fdfb:function(e,t,n){"use strict";var a=n("ab6f"),r=n.n(a);r.a}}]);