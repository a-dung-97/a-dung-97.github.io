(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-849a53c6"],{"0baa":function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"a",(function(){return a})),r.d(e,"d",(function(){return s})),r.d(e,"c",(function(){return c}));var n=r("b775");function o(t,e){return Object(n["a"])({url:"/tags/".concat(e),method:"delete",data:t})}function a(t,e){return Object(n["a"])({url:"/tags/".concat(e),method:"put",data:t})}function s(t,e){return Object(n["a"])({url:"/tags",method:"get",params:{type:t,name:e}})}function c(t,e){return Object(n["a"])({url:"/tags/".concat(t,"/").concat(e),method:"get"})}},3699:function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return a})),r.d(e,"d",(function(){return s})),r.d(e,"e",(function(){return c})),r.d(e,"a",(function(){return i}));var n=r("b775");function o(t){return Object(n["a"])({url:"/leads",method:"get",params:t})}function a(t,e){return Object(n["a"])({url:"/leads/".concat(t),method:"get",params:e})}function s(t){return Object(n["a"])({url:"/leads",method:"post",data:t})}function c(t,e){return Object(n["a"])({url:"/leads/".concat(e),method:"put",data:t})}function i(t,e){return Object(n["a"])({url:"/leads/convert/".concat(e),method:"post",data:t})}},"39a7":function(t,e,r){"use strict";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-row",[r("el-col",{attrs:{span:24}},[t.isEdit?r("el-button",{staticClass:"fr",attrs:{type:"success"},on:{click:t.updateOpportunity}},[t._v("Cập nhật")]):r("el-button",{staticClass:"fr",attrs:{size:"medium",type:"primary"},on:{click:t.createOpportunity}},[t._v("Lưu")])],1),t._v(" "),r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-position":"left","label-width":"150px"}},[r("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:24}},[r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("Thông tin cơ hội")])]),t._v(" "),r("el-row",{attrs:{gutter:30}},[r("el-col",{attrs:{md:12,sm:24}},[r("el-form-item",{attrs:{label:"Chủ sở hữu",prop:"ownerable_id"}},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-select",{on:{change:function(e){t.form.ownerable_id=""}},model:{value:t.form.ownerable_type,callback:function(e){t.$set(t.form,"ownerable_type",e)},expression:"form.ownerable_type"}},[r("el-option",{attrs:{value:"App\\User",label:"Nhân viên"}}),t._v(" "),r("el-option",{attrs:{value:"App\\Group",label:"Nhóm"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:18}},[r("el-select",{staticClass:"w-100",attrs:{filterable:"",placeholder:"Chọn chủ sở hữu"},model:{value:t.form.ownerable_id,callback:function(e){t.$set(t.form,"ownerable_id",e)},expression:"form.ownerable_id"}},["App\\User"==t.form.ownerable_type?t._l(t.userOptions,(function(e){return r("el-option",{key:e.id,staticStyle:{"max-height":"100%"},attrs:{label:e.name,value:e.id}},[r("span",{staticStyle:{float:"left"}},[t._v(t._s(e.name))]),t._v(" "),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.email))])])})):t._l(t.groupOptions,(function(e){return r("el-option",{key:e.id,staticStyle:{"max-height":"100%"},attrs:{disabled:0==e.count,label:e.name,value:e.id}},[r("span",{staticStyle:{float:"left"}},[t._v(t._s(e.name))]),t._v(" "),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.count+" nhân viên"))])])}))],2)],1)],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Tên"}},[r("el-input",{attrs:{placeholder:"Nhập tên"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"Khách hàng",prop:"customer_id"}},[r("el-input",{ref:"input",attrs:{clearable:"",placeholder:"Chọn khách hàng"},on:{focus:function(e){return t.openDialog("customer")},clear:function(e){t.form.customer_id=""}},model:{value:t.customer,callback:function(e){t.customer=e},expression:"customer"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"Liên hệ"}},[r("el-input",{ref:"input1",attrs:{disabled:!t.form.customer_id,clearable:"",placeholder:"Chọn liên hệ"},on:{focus:function(e){return t.openDialog("contact")},clear:function(e){t.form.contact_id=""}},model:{value:t.contact,callback:function(e){t.contact=e},expression:"contact"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"Kiểu"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Chọn kiểu"},model:{value:t.form.type_id,callback:function(e){t.$set(t.form,"type_id",e)},expression:"form.type_id"}},t._l(t.catalogs["Kiểu"],(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Bước tiếp theo"}},[r("el-input",{attrs:{placeholder:"Nhập bước tiếp theo"},model:{value:t.form.next_step,callback:function(e){t.$set(t.form,"next_step",e)},expression:"form.next_step"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"Ngày kết thúc",prop:"end_date"}},[r("el-date-picker",{staticClass:"w-100",attrs:{type:"date",placeholder:"Chọn ngày kết thúc",format:"dd/MM/yyyy","value-format":"yyyy-MM-dd"},model:{value:t.form.end_date,callback:function(e){t.$set(t.form,"end_date",e)},expression:"form.end_date"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"Trạng thái"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Chọn trạng thái"},model:{value:t.form.status_id,callback:function(e){t.$set(t.form,"status_id",e)},expression:"form.status_id"}},t._l(t.catalogs["Trạng thái"],(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Nguồn"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Chọn nguồn"},model:{value:t.form.source_id,callback:function(e){t.$set(t.form,"source_id",e)},expression:"form.source_id"}},t._l(t.catalogs["Nguồn"],(function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Xác suất thành công"}},[r("el-input-number",{staticClass:"w-100",attrs:{placeholder:"Nhập xác suất thành công",precision:2,step:1,max:100,"controls-position":"right"},model:{value:t.form.probability_of_success,callback:function(e){t.$set(t.form,"probability_of_success",e)},expression:"form.probability_of_success"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"Giá trị"}},[r("el-input",{attrs:{type:"number",placeholder:"Nhập giá trị"},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"Doanh số kì vọng"}},[r("el-input",{attrs:{type:"number",placeholder:"Nhập doanh số kì vọng"},model:{value:t.form.expected_sales,callback:function(e){t.$set(t.form,"expected_sales",e)},expression:"form.expected_sales"}})],1)],1)],1)],1)],1),t._v(" "),r("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:24}},[r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[t._v("Thông tin mô tả")]),t._v(" "),r("el-input",{attrs:{type:"textarea"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1),t._v(" "),r("SelectCustomer",{attrs:{type:t.type,"show-dialog":t.showDialog,customer:t.form.customer_id},on:{"handle-select":t.handleSelect,"update:showDialog":function(e){t.showDialog=e},"update:show-dialog":function(e){t.showDialog=e}}})],1)],1)},o=[],a=(r("ac6a"),r("5df3"),r("96cf"),r("3b8d")),s=(r("7f7f"),r("856f")),c=r("ccd6"),i=r("5d63"),u={props:["isEdit","user"],components:{TagArea:c["a"],SelectCustomer:i["a"]},data:function(){return{type:"",customer:"",contact:"",showDialog:!1,name:"",form:{id:"",ownerable_type:"App\\User",ownerable_id:"",name:"",customer_id:"",contact_id:"",type_id:"",next_step:"",end_date:"",status_id:"",source_id:"",probability_of_success:null,value:"",expected_sales:"",description:""},rules:{ownerable_id:[{required:!0,message:"Hãy chọn chủ sở hữu",trigger:"blur"}],customer_id:[{required:!0,message:"Hãy chọn khách hàng"}],name:[{required:!0,message:"Hãy nhập tên cơ hội",trigger:"blur"}],end_date:[{required:!0,message:"Hãy chọn ngày kết thúc",trigger:"blur"}]},catalogs:{"Kiểu":[],"Nguồn":[],"Trạng thái":[]}}},methods:{openDialog:function(t){this.type="customer"==t?"App\\Customer":"App\\Contact",this.showDialog=!0,this.$refs["input"].blur(),this.$refs["input1"].blur()},handleSelect:function(t){"App\\Customer"==this.type?(this.customer=t.name,this.form.customer_id=t.id,this.form.contact_id="",this.contact=""):(this.contact=t.name,this.form.contact_id=t.id)},createOpportunity:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs["form"].validate();case 3:return this.openFullScreen(),t.next=6,Object(s["f"])(this.form);case 6:e=t.sent,r=e.data,this.closeFullScreen(),this.$router.push("/business/opportunity/show/".concat(r.id)),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0),t.t0.response&&this.closeFullScreen();case 16:case"end":return t.stop()}}),t,this,[[0,12]])})));function e(){return t.apply(this,arguments)}return e}(),getOpportunity:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.openFullScreen(),t.next=4,Object(s["e"])(this.$route.params.id,{edit:!0});case 4:for(n in e=t.sent,r=e.data,this.customer=r.customer,this.contact=r.contact,this.form)this.form[n]=r[n];this.closeFullScreen(),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0),this.closeFullScreen();case 16:case"end":return t.stop()}}),t,this,[[0,12]])})));function e(){return t.apply(this,arguments)}return e}(),updateOpportunity:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.openFullScreen(),t.next=4,this.$refs["form"].validate();case 4:return t.next=6,Object(s["g"])(this.form,this.$route.params.id);case 6:t.sent,this.closeFullScreen(),this.$router.push("/business/opportunity/show/".concat(this.$route.params.id)),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0),this.closeFullScreen();case 15:case"end":return t.stop()}}),t,this,[[0,11]])})));function e(){return t.apply(this,arguments)}return e}()},created:function(){this.user&&(this.form.customer_id=this.user.id,this.customer=this.user.name),Promise.all([this.getCatalog("Cơ hội","Kiểu"),this.getCatalog("Cơ hội","Nguồn"),this.getCatalog("Cơ hội","Trạng thái"),this.getUsers(),this.getGroups()]),this.isEdit&&this.getOpportunity()},mounted:function(){}},l=u,p=r("2877"),d=Object(p["a"])(l,n,o,!1,null,null,null);e["a"]=d.exports},"4a49":function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return a})),r.d(e,"d",(function(){return s})),r.d(e,"e",(function(){return c})),r.d(e,"a",(function(){return i}));var n=r("b775");function o(t){return Object(n["a"])({url:"/customers",method:"get",params:t})}function a(t,e){return Object(n["a"])({url:"/customers/".concat(t),method:"get",params:e})}function s(t){return Object(n["a"])({url:"/customers",method:"post",data:t})}function c(t,e){return Object(n["a"])({url:"/customers/".concat(e),method:"put",data:t})}function i(t,e,r){return Object(n["a"])({url:"/customers/".concat(t,"/").concat(e),method:"get",params:r})}},"5df3":function(t,e,r){"use strict";var n=r("02f4")(!0);r("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})}))},"856f":function(t,e,r){"use strict";r.d(e,"d",(function(){return o})),r.d(e,"f",(function(){return a})),r.d(e,"e",(function(){return s})),r.d(e,"g",(function(){return c})),r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return l}));var n=r("b775");function o(t){return Object(n["a"])({url:"/opportunities",method:"get",params:t})}function a(t){return Object(n["a"])({url:"/opportunities",method:"post",data:t})}function s(t,e){return Object(n["a"])({url:"/opportunities/".concat(t),method:"get",params:e})}function c(t,e){return Object(n["a"])({url:"/opportunities/".concat(e),method:"put",data:t})}function i(t){return Object(n["a"])({url:"/opportunities/".concat(t),method:"delete"})}function u(t,e){return Object(n["a"])({url:"/opportunities/".concat(t,"/orders"),method:"get",params:e})}function l(t,e){return Object(n["a"])({url:"/opportunities/".concat(t,"/quotes"),method:"get",params:e})}},a88e:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("OpportunityDetail",{attrs:{"is-edit":!0}})],1)},o=[],a=r("39a7"),s={components:{OpportunityDetail:a["a"]}},c=s,i=r("2877"),u=Object(i["a"])(c,n,o,!1,null,null,null);e["default"]=u.exports},dd64:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return s})),r.d(e,"d",(function(){return c}));var n=r("b775");function o(t){return Object(n["a"])({url:"/contacts",method:"get",params:t})}function a(t,e){return Object(n["a"])({url:"/contacts/".concat(t),method:"get",params:e})}function s(t){return Object(n["a"])({url:"/contacts",method:"post",data:t})}function c(t,e){return Object(n["a"])({url:"/contacts/".concat(e),method:"put",data:t})}}}]);