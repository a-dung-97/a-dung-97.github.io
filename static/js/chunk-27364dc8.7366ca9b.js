(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27364dc8"],{"385d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("WebformDetail",{attrs:{isEdit:!0}})},n=[],l=r("b67f"),i={components:{WebformDetail:l["a"]}},o=i,s=r("2877"),c=Object(s["a"])(o,a,n,!1,null,null,null);t["default"]=c.exports},"457e":function(e,t,r){},"5df3":function(e,t,r){"use strict";var a=r("02f4")(!0);r("01f9")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=a(t,r),this._i+=e.length,{value:e,done:!1})}))},b3b6:function(e,t,r){"use strict";var a=r("457e"),n=r.n(a);n.a},b67f:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"left","label-width":"150px"}},[r("div",{staticClass:"app-container"},[r("el-row",{staticClass:"mb-20",attrs:{gutter:50}},[r("el-col",{attrs:{span:8}},[r("el-input",{attrs:{disabled:3==e.active,placeholder:"Nhập tên webform"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-input",{attrs:{disabled:3==e.active,placeholder:"Nhập tên chiến dịch"},model:{value:e.form.campaign,callback:function(t){e.$set(e.form,"campaign",t)},expression:"form.campaign"}})],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("div",{staticClass:"fr"},[2==e.active?r("el-button",{on:{click:function(t){e.active=1}}},[e._v("Quay lại")]):e._e(),e._v(" "),1==e.active?r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.active=2}}},[e._v("Tiếp theo")]):e._e(),e._v(" "),2!=e.active||e.isEdit?e._e():r("el-button",{attrs:{type:"primary"},on:{click:e.createWebform}},[e._v("Lưu")]),e._v(" "),2==e.active&&e.isEdit?r("el-button",{attrs:{type:"primary"},on:{click:e.updateWebform}},[e._v("Cập nhật")]):e._e(),e._v(" "),3==e.active?r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push("/marketing/webform/index")}}},[e._v("Trở về")]):e._e()],1)])],1),e._v(" "),r("el-steps",{staticClass:"mb-20",attrs:{active:e.active,"align-center":""}},[r("el-step",{attrs:{title:"Bạn cần lấy thông tin gì?"}}),e._v(" "),r("el-step",{attrs:{title:"Thiết lập"}}),e._v(" "),r("el-step",{attrs:{title:"Mã nhúng"}})],1),e._v(" "),1==e.active?r("el-row",{attrs:{gutter:40}},[r("el-col",{attrs:{xs:24,span:12}},[r("el-table",{attrs:{data:e.tableData}},[r("el-table-column",{attrs:{label:"STT",type:"index",width:"50",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"Tên trường"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"Tên trường"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:e.form.field[t.row.field],callback:function(r){e.$set(e.form.field,t.row.field,r)},expression:"form.field[scope.row.field]"}})]}}],null,!1,4126163562)})],1)],1),e._v(" "),r("el-col",{attrs:{xs:24,span:12}},[r("Webform",{attrs:{field:e.form.field,demo:!0,name:e.form.name}})],1)],1):e._e(),e._v(" "),2==e.active?r("el-card",[r("el-row",{attrs:{gutter:30}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"Chủ sở hữu",prop:"ownerable_id"}},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-select",{on:{change:function(t){e.form.ownerable_id=""}},model:{value:e.form.ownerable_type,callback:function(t){e.$set(e.form,"ownerable_type",t)},expression:"form.ownerable_type"}},[r("el-option",{attrs:{value:"App\\User",label:"Nhân viên"}}),e._v(" "),r("el-option",{attrs:{value:"App\\Group",label:"Nhóm"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:18}},[r("el-select",{staticClass:"w-100",attrs:{disabled:!e.form.ownerable_type,filterable:"",placeholder:"Chọn chủ sở hữu"},model:{value:e.form.ownerable_id,callback:function(t){e.$set(e.form,"ownerable_id",t)},expression:"form.ownerable_id"}},["App\\User"==e.form.ownerable_type?e._l(e.userOptions,(function(t){return r("el-option",{key:t.id,staticStyle:{"max-height":"100%"},attrs:{label:t.name,value:t.id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),e._v(" "),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.email))])])})):e._l(e.groupOptions,(function(t){return r("el-option",{key:t.id,staticStyle:{"max-height":"100%"},attrs:{disabled:0==t.count,label:t.name,value:t.id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),e._v(" "),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.count+" nhân viên"))])])}))],2)],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"Tên miền",prop:"url"}},[r("el-input",{attrs:{placeholder:"Nhập tên miền của bạn"},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}},[r("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.protocol,callback:function(t){e.protocol=t},expression:"protocol"}},[r("el-option",{attrs:{label:"https://",value:"https:"}}),e._v(" "),r("el-option",{attrs:{label:"http://",value:"http:"}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"URL điều hướng",prop:"redirect_url"}},[r("el-input",{attrs:{placeholder:"Nhập URL điều hướng"},model:{value:e.form.redirect_url,callback:function(t){e.$set(e.form,"redirect_url",t)},expression:"form.redirect_url"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"Ngôn ngữ",prop:"language"}},[r("el-select",{staticClass:"w-100",model:{value:e.form.language,callback:function(t){e.$set(e.form,"language",t)},expression:"form.language"}},[r("el-option",{attrs:{label:"Tiếng Việt",value:1}}),e._v(" "),r("el-option",{attrs:{label:"English",disabled:"",value:0}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"Chiều rộng",prop:"width"}},[r("el-input-number",{staticClass:"w-100",attrs:{min:0},model:{value:e.form.width,callback:function(t){e.$set(e.form,"width",t)},expression:"form.width"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Chiều cao",prop:"height"}},[r("el-input-number",{staticClass:"w-100",attrs:{min:0},model:{value:e.form.height,callback:function(t){e.$set(e.form,"height",t)},expression:"form.height"}})],1)],1)],1)],1):e._e(),e._v(" "),3==e.active?r("el-card",[r("el-row",{attrs:{gutter:30}},[r("el-col",{attrs:{span:20}},[r("el-input",{attrs:{type:"textarea",disabled:""},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.copy(e.code,t)}}},[r("i",{staticClass:"el-icon-document-copy"}),e._v(" Copy\n                    ")])],1)],1)],1):e._e()],1)])},n=[],l=(r("ac6a"),r("5df3"),r("7f7f"),r("96cf"),r("3b8d")),i=r("f71e"),o=r("e68e"),s=r("bc09"),c=r("61f7"),u={components:{Webform:s["a"]},props:["isEdit"],data:function(){return{active:1,code:"",tableData:[{name:"Số điện thoại",field:"phone_number"},{name:"Số di động",field:"mobile_number"},{name:"Email",field:"email"},{name:"Công ty",field:"company"},{name:"Địa chỉ",field:"office_address"}],protocol:"https:",form:{id:"",name:"",field:{phone_number:!0,mobile_number:!0,email:!0,company:!0,office_address:!0},url:"",language:1,campaign:"",redirect_url:"",width:"",height:"",ownerable_type:"",ownerable_id:""},rules:{ownerable_id:[{required:!0,message:"Hãy nhập tên chủ sở hữu tiềm năng",trigger:"blur"}],url:[{validator:c["b"],trigger:"blur"}],redirect_url:[{type:"url",message:"URL không đúng định dạng",trigger:"blur"}],language:[{required:!0,message:"Hãy chọn ngôn ngữ",trigger:"blur"}],width:[{required:!0,message:"Hãy nhập độ rộng",trigger:"blur"}],height:[{required:!0,message:"Hãy nhập chiều cao",trigger:"blur"}]}}},methods:{copy:function(e,t){Object(i["a"])(e,t)},createWebform:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,""!=this.form.name){e.next=4;break}return this.$message.error("Bạn chưa nhập tên webform"),e.abrupt("return");case 4:return e.next=6,this.$refs["form"].validate();case 6:return this.form.url=this.protocol+"//"+this.form.url,this.openFullScreen(),e.next=10,Object(o["f"])(this.form);case 10:t=e.sent,r=t.data,this.active=3,this.code='<iframe src="'.concat("https://crm.adung.me/","webform/generated?id=").concat(r.id,'" width="').concat(this.form.width,'" height="').concat(this.form.height,'" frameborder="0"></iframe>'),this.closeFullScreen(),this.$message.success("Thêm webform thành công"),e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](0),console.log(e.t0),this.closeFullScreen();case 22:case"end":return e.stop()}}),e,this,[[0,18]])})));function t(){return e.apply(this,arguments)}return t}(),updateWebform:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,""!=this.form.name){e.next=4;break}return this.$message.error("Bạn chưa nhập tên webform"),e.abrupt("return");case 4:return e.next=6,this.$refs["form"].validate();case 6:return this.form.url=this.protocol+"//"+this.form.url,this.openFullScreen(),e.next=10,Object(o["g"])(this.form,this.$route.params.id);case 10:this.active=3,this.code='<iframe src="'.concat("https://crm.adung.me/","webform/generated?id=").concat(this.$route.params.id,'" width="').concat(this.form.width,'" height="').concat(this.form.height,'" frameborder="0"></iframe>'),this.closeFullScreen(),this.$message.success("Sửa dữ liệu thành công"),e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](0),console.log(e.t0),this.closeFullScreen();case 20:case"end":return e.stop()}}),e,this,[[0,16]])})));function t(){return e.apply(this,arguments)}return t}(),getWebform:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.openFullScreen(),e.next=3,Object(o["e"])(this.$route.params.id);case 3:for(a in t=e.sent,r=t.data,this.form)"url"!=a&&(this.form[a]=r[a]);n=new URL(r.url),this.protocol=n.protocol,this.form.url=n.hostname,this.closeFullScreen();case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){Promise.all([this.getUsers(),this.getGroups()]),this.isEdit&&this.getWebform()}},m=u,p=(r("b3b6"),r("2877")),f=Object(p["a"])(m,a,n,!1,null,null,null);t["a"]=f.exports}}]);